/*
<!-- Plotly chart will be drawn inside this DIV -->
  <div class="views-row--double">
    <div id="chartdiv"></div>
  </div>

  <script>

   // This example uses pulsating circles CSS by Kevin Urrutia
   // http://kevinurrutia.tumblr.com/post/16411271583/creating-a-css3-pulsating-circle


  var map = AmCharts.makeChart( "chartdiv", {
    type: "map",
    theme: "light",
    backgroundColor: "#2980b9",
    backgroundAlpha:1,
    fontFamily: "Source Sans Pro",
    dragMap: false,

    zoomControl: {
  		zoomControlEnabled: false,
      homeButtonEnabled: false,
  	},

    imagesSettings: {
      rollOverColor: "#16a085",
      rollOverScale: 3,
      selectedScale: 3,
      selectedColor: "#16a085",
      color: "#16a085",
    },

    areasSettings: {
      color: "#f1c40f",
      alpha: 1,
      unlistedAreasColor: "#f1c40f",
      unlistedAreasAlpha: 1,
      outlineThickness: 01,
      outlineColor: "#fff",
    },

    dataProvider: {
      map: "worldLow",
      zoomLevel: 2,
      zoomLongitude: -0.37739,
      zoomLatitude: 39.46975,
      images: [ {
        title: "Paris",
        latitude: 48.8567,
        longitude: 2.3510
      }, {
        title: "Madrid",
        latitude: 40.4167,
        longitude: -3.7033
      }, {
        title: "Ankara",
        latitude: 39.9439,
        longitude: 32.8560
      }, {
        title: "Buenos Aires",
        latitude: -34.6118,
        longitude: -58.4173
      }, {
        title: "Brasilia",
        latitude: -15.7801,
        longitude: -47.9292
      }, {
        title: "Kinshasa",
        latitude: -4.3369,
        longitude: 15.3271
      }, {
        title: "Cairo",
        latitude: 30.0571,
        longitude: 31.2272
      }]
    }
  } );

  // add events to recalculate map position when the map is moved or zoomed
  map.addListener( "positionChanged", updateCustomMarkers );

  // this function will take current images on the map and create HTML elements for them
  function updateCustomMarkers( event ) {
    // get map object
    var map = event.chart;

    // go through all of the images
    for ( var x in map.dataProvider.images ) {
      // get MapImage object
      var image = map.dataProvider.images[ x ];

      // check if it has corresponding HTML element
      if ( 'undefined' == typeof image.externalElement )
        image.externalElement = createCustomMarker( image );

      // reposition the element accoridng to coordinates
      var xy = map.coordinatesToStageXY( image.longitude, image.latitude );
      image.externalElement.style.top = xy.y + 'px';
      image.externalElement.style.left = xy.x + 'px';
    }
  }

  // this function creates and returns a new marker element
  function createCustomMarker( image ) {
    // create holder
    var holder = document.createElement( 'div' );
    holder.className = 'map-marker';
    holder.title = image.title;
    holder.style.position = 'absolute';

    // maybe add a link to it?
    if ( undefined != image.url ) {
      holder.onclick = function() {
        window.location.href = image.url;
      };
      holder.className += ' map-clickable';
    }

    // create dot
    var dot = document.createElement( 'div' );
    dot.className = 'dot';
    holder.appendChild( dot );

    // create pulse
    var pulse = document.createElement( 'div' );
    pulse.className = 'pulse';
    holder.appendChild( pulse );

    // append the marker to the map container
    image.chart.chartDiv.appendChild( holder );

    return holder;
  }
  </script>
  */
  #chartdiv {
    width: 100%;
    height: 200px;
  }
  @media (min-width: $screen-sm-min) {
    #chartdiv {
      height: 400px;
    }
  }

  // footer stuff trick investigating
  .map-marker {
      /* adjusting for the marker dimensions
      so that it is centered on coordinates */
      margin-left: -8px;
      margin-top: -8px;
  }
  .map-marker.map-clickable {
      cursor: pointer;
  }
  .pulse {
      width: 20px;
      height: 20px;
      border: 5px solid $brand-primary;
      -webkit-border-radius: 60px;
      -moz-border-radius: 60px;
      border-radius: 60px;
      background-color: $brand-primary;
      z-index: 10;
      position: absolute;
    }
  .map-marker .dot {
      border: 20px solid $brand-primary;
      background: transparent;
      -webkit-border-radius: 120px;
      -moz-border-radius: 120px;
      border-radius: 120px;
      height: 100px;
      width: 100px;
      -webkit-animation: pulse 3s ease-out;
      -moz-animation: pulse 3s ease-out;
      animation: pulse 3s ease-out;
      -webkit-animation-iteration-count: infinite;
      -moz-animation-iteration-count: infinite;
      animation-iteration-count: infinite;
      position: absolute;
      top: -40px;
      left: -40px;
      z-index: 1;
      opacity: 0;
    }
    @-moz-keyframes pulse {
     0% {
        -moz-transform: scale(0);
        opacity: 0.0;
     }
     25% {
        -moz-transform: scale(0);
        opacity: 0.1;
     }
     50% {
        -moz-transform: scale(0.1);
        opacity: 0.3;
     }
     75% {
        -moz-transform: scale(0.5);
        opacity: 0.5;
     }
     100% {
        -moz-transform: scale(1);
        opacity: 0.0;
     }
    }
    @-webkit-keyframes "pulse" {
     0% {
        -webkit-transform: scale(0);
        opacity: 0.0;
     }
     25% {
        -webkit-transform: scale(0);
        opacity: 0.1;
     }
     50% {
        -webkit-transform: scale(0.1);
        opacity: 0.3;
     }
     75% {
        -webkit-transform: scale(0.5);
        opacity: 0.5;
     }
     100% {
        -webkit-transform: scale(1);
        opacity: 0.0;
     }
    }
